## راهنمای جامع دستور `git fetch`

دستور `git fetch` یکی از ابزارهای قدرتمند گیت (Git) برای همگام‌سازی پروژه‌های محلی با مخزن‌های راه دور (remote repository) است. این دستور تغییرات جدید را از مخزن راه دور دریافت می‌کند، بدون اینکه آن‌ها را به‌طور خودکار با شاخه‌های محلی ادغام کند. در واقع، `git fetch` به شما اجازه می‌دهد که تغییرات جدید را ببینید و سپس تصمیم بگیرید که آیا آن‌ها را با شاخه محلی خود ادغام کنید یا خیر.

### دستور `git fetch` چه کاری انجام می‌دهد؟

دستور `git fetch` به گیت می‌گوید که اطلاعات جدید را از یک مخزن راه دور دانلود کند و شاخه‌های راه دور (remote branches) را به‌روز کند. با استفاده از این دستور، گیت کپی‌ای از تاریخچه کامیت‌های جدید و تغییرات را از مخزن راه دور دریافت می‌کند، بدون اینکه شاخه فعلی شما تغییر کند. این تغییرات دانلود شده به طور جداگانه ذخیره می‌شوند و تنها زمانی که شما دستور `git merge` یا `git rebase` اجرا کنید، شاخه محلی شما با این تغییرات ادغام می‌شود.

#### سینتکس کلی:

```bash
git fetch [<remote>] [<branch>]
```

- **`<remote>`:** نام مخزن راه دوری که می‌خواهید تغییرات آن را دریافت کنید (معمولاً `origin`).
- **`<branch>`:** نام شاخه‌ای که می‌خواهید از آن تغییرات دریافت کنید (در صورت نیاز به دریافت تغییرات از شاخه خاص).

#### نمونه استفاده:

1. **دریافت تمامی تغییرات از مخزن راه دور (تمام شاخه‌ها):**

```bash
git fetch
```

این دستور تغییرات تمامی شاخه‌های راه دور را دریافت می‌کند و آن‌ها را در مخزن محلی شما به‌روزرسانی می‌کند، بدون ادغام تغییرات.

2. **دریافت تغییرات از یک مخزن راه دور خاص:**

```bash
git fetch origin
```

این دستور تغییرات را فقط از مخزن راه دور `origin` دریافت می‌کند.

3. **دریافت تغییرات یک شاخه خاص از مخزن راه دور:**

```bash
git fetch origin main
```

این دستور تغییرات شاخه‌ی `main` از مخزن راه دور `origin` را دریافت می‌کند.

#### خروجی `git fetch`

هنگامی که دستور `git fetch` اجرا می‌شود، گیت تغییرات جدید را دریافت کرده و اطلاعات شاخه‌های راه دور را به‌روزرسانی می‌کند. برای مشاهده تغییرات جدیدی که دریافت کرده‌اید، می‌توانید از دستور `git log` یا `git status` استفاده کنید.

### تفاوت بین `git fetch` و `git pull`

یکی از اشتباهات رایج در گیت این است که کاربران دستور `git fetch` و `git pull` را به جای یکدیگر استفاده می‌کنند. در حالی که این دو دستور عملکردی متفاوت دارند.

- **`git fetch`:** فقط تغییرات جدید را از مخزن راه دور دریافت می‌کند و آن‌ها را به مخزن محلی اضافه می‌کند، اما تغییرات را با شاخه محلی ادغام نمی‌کند. این به شما اجازه می‌دهد قبل از ادغام تغییرات آن‌ها را بررسی کنید.
- **`git pull`:** ترکیبی از `git fetch` و `git merge` است. ابتدا تغییرات را از مخزن راه دور دریافت می‌کند و سپس آن‌ها را به‌طور خودکار با شاخه محلی ادغام می‌کند. اگر تغییرات ناسازگار باشند، ممکن است با مشکلات ادغام (merge conflicts) روبه‌رو شوید.

#### مثال برای `git pull`:

```bash
git pull origin main
```

این دستور ابتدا تغییرات شاخه‌ی `main` در مخزن `origin` را دریافت کرده و سپس آن‌ها را با شاخه‌ی فعلی شما ادغام می‌کند.

### چه اتفاقی در پس‌زمینه دستور `git fetch` می‌افتد؟

وقتی شما دستور `git fetch` را اجرا می‌کنید، گیت به سرور راه دور متصل می‌شود و آخرین تغییرات و کامیت‌های جدید را از مخزن راه دور دانلود می‌کند. این فرآیند شامل مراحل زیر است:

1. **ارتباط با مخزن راه دور:**
   - گیت به مخزن راه دور (remote repository) متصل می‌شود و تغییراتی که از آخرین بار همگام‌سازی دریافت نشده‌اند را شناسایی می‌کند.
2. **دانلود تغییرات:**
   - گیت تمام تغییرات جدید (کامیت‌ها، فایل‌ها و شاخه‌های جدید) را از مخزن راه دور دانلود می‌کند و آن‌ها را در مخزن محلی شما ذخیره می‌کند. این تغییرات در شاخه‌های راه دور (remote branches) مانند `origin/main` ذخیره می‌شوند.
3. **عدم ادغام با شاخه محلی:**
   - در طول فرآیند `git fetch`، گیت هیچ‌گونه تغییراتی را با شاخه محلی شما ادغام نمی‌کند. تمام تغییرات جدید در شاخه‌های راه دور ذخیره می‌شوند و شما می‌توانید آن‌ها را قبل از هرگونه ادغام بررسی کنید.

#### فایل‌های موقت و اطلاعات شاخه‌ها:

در پشت صحنه، گیت تغییرات جدید را در پوشه‌های مخفی خود مانند `.git/refs/remotes/` ذخیره می‌کند. هر مخزن راه دور یک مسیر جداگانه در این پوشه دارد و شاخه‌های راه دور به‌صورت `refs/remotes/origin/` در اینجا ذخیره می‌شوند. این شاخه‌ها نمایانگر تغییرات راه دور هستند و می‌توانید قبل از ادغام، آن‌ها را بررسی کنید.

### گزینه‌های پرکاربرد با `git fetch`

#### 1. **`git fetch --all`:**

این دستور تغییرات تمام مخازن راه دوری که در پروژه تعریف کرده‌اید (نه فقط `origin`) را دریافت می‌کند.

```bash
git fetch --all
```

#### 2. **`git fetch --dry-run`:**

اگر می‌خواهید ببینید چه تغییراتی بدون اعمال آن‌ها دریافت خواهد شد، می‌توانید از گزینه `--dry-run` استفاده کنید. این گزینه فقط گزارش تغییرات را نمایش می‌دهد بدون آنکه چیزی دریافت یا به‌روزرسانی شود.

```bash
git fetch --dry-run
```

#### 3. **`git fetch --prune`:**

این گزینه برای حذف شاخه‌های راه دوری که دیگر در مخزن راه دور وجود ندارند مفید است. اگر شاخه‌ای در مخزن راه دور حذف شده باشد، با استفاده از این دستور می‌توانید آن شاخه‌ها را از مخزن محلی خود پاک کنید.

```bash
git fetch --prune
```

### استفاده از `git fetch` در کارهای روزمره

1. **بررسی تغییرات قبل از ادغام:**
   قبل از ادغام تغییرات با شاخه محلی خود، از `git fetch` استفاده کنید تا ابتدا تغییرات جدید را دریافت و بررسی کنید. این کار به شما اجازه می‌دهد از مشکلات ادغام جلوگیری کنید و قبل از هر اقدامی تغییرات را ببینید.

2. **همگام‌سازی بدون اعمال فوری:**
   اگر می‌خواهید مخزن محلی خود را با مخزن راه دور همگام‌سازی کنید اما نمی‌خواهید تغییرات جدید را فوراً اعمال کنید، `git fetch` بهترین گزینه است.

3. **مدیریت شاخه‌های راه دور:**
   با استفاده از `git fetch --prune` می‌توانید شاخه‌های قدیمی و حذف‌شده در مخزن راه دور را از مخزن محلی خود حذف کنید تا شاخه‌های نامعتبر را مدیریت کنید.

### نکات و ترفندها

#### 1. **استفاده منظم از `git fetch`:**

بهتر است به طور منظم از `git fetch` استفاده کنید تا مطمئن شوید که همیشه به‌روز هستید و از تغییرات در مخزن راه دور آگاهید، بدون اینکه شاخه محلی شما تغییر کند. این کار کمک می‌کند که از مشکلات احتمالی ادغام جلوگیری کنید.

#### 2. **بررسی تغییرات پس از `git fetch`:**

پس از اجرای `git fetch`، از دستور `git log` یا `git diff` استفاده کنید تا تغییرات جدید را قبل از ادغام ببینید. به این ترتیب، می‌توانید تغییرات را بررسی و کنترل کنید.

```bash
git log origin/main
```

این دستور لیست کامیت‌های جدید دریافت‌شده از شاخه `main` مخزن راه دور `origin` را نمایش می‌دهد.

#### 3. **ادغام تغییرات پس از fetch:**

پس از اجرای `git fetch`، می‌توانید تغییرات را با دستور `git merge` یا `git rebase` به شاخه محلی خود اضافه کنید.

```bash
git merge origin/main
```

این دستور تغییرات شاخه `main` از مخزن `origin` را با شاخه فعلی شما ادغام می‌کند.

### نتیجه‌گیری

دستور `git fetch` ابزاری قدرتمند برای همگام‌سازی مخازن محلی با مخازن راه دور است، بدون اینکه تغییرات به‌طور خودکار در شاخه محلی اعمال شود. این دستور به شما اجازه می‌دهد که تغییرات جدید را قبل از ادغام بررسی و کنترل کنید و از بروز مشکلات در ادغام‌ها جلوگیری کنید. با استفاده منظم از `git fetch` می‌توانید پروژه‌های خود را

به‌روز نگه داشته و به طور موثر با تیم خود همکاری کنید.
