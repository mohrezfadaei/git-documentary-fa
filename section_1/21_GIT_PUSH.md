## راهنمای جامع دستور `git push`

دستور `git push` یکی از مهم‌ترین دستورات گیت (Git) است که برای ارسال تغییرات از مخزن محلی (local repository) به مخزن راه دور (remote repository) استفاده می‌شود. به کمک این دستور، تغییرات (کامیت‌ها) و به‌روزرسانی‌هایی که در شاخه‌های محلی ایجاد شده‌اند به مخزن راه دور ارسال می‌شوند تا دیگران نیز بتوانند به این تغییرات دسترسی داشته باشند.

### دستور `git push` چه کاری انجام می‌دهد؟

دستور `git push` تغییرات موجود در شاخه محلی شما را به مخزن راه دور منتقل می‌کند. این تغییرات می‌تواند شامل کامیت‌های جدید، تغییرات شاخه‌ها، یا تگ‌های جدید باشد. پس از اجرای این دستور، مخزن راه دور همگام با مخزن محلی شما می‌شود و تغییرات انجام شده به صورت دائمی در آن ذخیره می‌شوند.

#### سینتکس کلی:

```bash
git push [<remote>] [<branch>]
```

- **`<remote>`**: نام مخزن راه دور (به طور پیش‌فرض `origin` است).
- **`<branch>`**: نام شاخه‌ای که تغییرات آن باید به مخزن راه دور ارسال شود (مثلاً `main` یا `master`).

#### نمونه‌های استفاده:

1. **ارسال تغییرات به مخزن راه دور پیش‌فرض (origin) در شاخه فعلی:**

```bash
git push
```

این دستور تغییرات شاخه فعلی را به مخزن راه دور `origin` ارسال می‌کند.

2. **ارسال تغییرات یک شاخه خاص به مخزن راه دور:**

```bash
git push origin main
```

این دستور تغییرات شاخه `main` را به مخزن راه دور `origin` ارسال می‌کند.

3. **ارسال تگ‌ها به مخزن راه دور:**

```bash
git push origin --tags
```

این دستور تمامی تگ‌های موجود در مخزن محلی را به مخزن راه دور ارسال می‌کند.

#### خروجی `git push`:

```plaintext
Counting objects: 100% (5/5), done.
Delta compression using up to 4 threads.
Compressing objects: 100% (3/3), done.
Writing objects: 100% (3/3), 1.23 KiB | 1.23 MiB/s, done.
Total 3 (delta 1), reused 0 (delta 0)
To https://github.com/user/repository.git
   d6f8e67..b3a9e12  main -> main
```

در این خروجی، گیت نشان می‌دهد که چند فایل تغییر کرده و این تغییرات با چه نرخ فشرده‌سازی به مخزن راه دور ارسال شده است. همچنین شاخه‌ای که تغییرات در آن اعمال شده (`main`) نیز نمایش داده می‌شود.

### چه اتفاقی در پس‌زمینه دستور `git push` می‌افتد؟

وقتی دستور `git push` اجرا می‌شود، چندین فرآیند پشت سر هم انجام می‌شود تا تغییرات به مخزن راه دور ارسال شود:

#### 1. **بررسی وضعیت شاخه محلی و راه دور:**

ابتدا گیت بررسی می‌کند که آیا شاخه محلی شما به‌روز است و تغییراتی نسبت به شاخه راه دور دارد یا خیر. اگر شاخه راه دور تغییراتی داشته باشد که شما هنوز دریافت نکرده‌اید، گیت از شما می‌خواهد ابتدا تغییرات را با `git pull` همگام‌سازی کنید.

#### 2. **ارسال کامیت‌ها به مخزن راه دور:**

اگر شاخه محلی شما تغییرات جدیدی داشته باشد (کامیت‌های جدید)، گیت این کامیت‌ها را به مخزن راه دور ارسال می‌کند. این کامیت‌ها شامل تمام اطلاعات تغییرات در فایل‌ها و تاریخچه آن‌ها است.

#### 3. **فشرده‌سازی تغییرات:**

قبل از ارسال کامیت‌ها، گیت تغییرات را فشرده می‌کند تا حجم داده‌ها کاهش یابد و ارسال سریع‌تر انجام شود. پس از آن، داده‌های فشرده به مخزن راه دور ارسال می‌شوند.

#### 4. **به‌روزرسانی شاخه‌ها:**

پس از ارسال کامیت‌ها، گیت شاخه‌های مربوطه را به‌روز می‌کند تا نشان دهد که شاخه‌های محلی و راه دور همگام‌سازی شده‌اند. اگر شما شاخه جدیدی ایجاد کرده باشید و آن را push کنید، این شاخه نیز به شاخه‌های مخزن راه دور اضافه می‌شود.

#### 5. **تایید تغییرات:**

در نهایت، گیت به شما تایید می‌کند که تغییرات با موفقیت به مخزن راه دور ارسال شده‌اند و شاخه‌های محلی و راه دور همگام‌سازی شده‌اند.

### تفاوت `git push` با `git pull`

- **`git push`:** تغییرات موجود در مخزن محلی را به مخزن راه دور ارسال می‌کند.
- **`git pull`:** تغییرات جدید موجود در مخزن راه دور را به مخزن محلی دریافت و با شاخه محلی ادغام می‌کند.

#### مثال:

1. **ارسال تغییرات به مخزن راه دور:**

   ```bash
   git push origin main
   ```

2. **دریافت تغییرات از مخزن راه دور و ادغام آن‌ها:**
   ```bash
   git pull origin main
   ```

### گزینه‌های پرکاربرد با `git push`

#### 1. **`git push --force`**

اگر تغییراتی در شاخه محلی انجام داده‌اید که نمی‌خواهید با تغییرات قبلی مخزن راه دور همگام باشد (برای مثال، بازنویسی تاریخچه)، می‌توانید از `--force` استفاده کنید. این گزینه تغییرات شما را بدون در نظر گرفتن تغییرات موجود در مخزن راه دور ارسال می‌کند.

```bash
git push --force origin main
```

**هشدار:** استفاده از `--force` ممکن است باعث از دست رفتن تغییرات دیگران شود، بنابراین باید با احتیاط استفاده شود.

#### 2. **`git push --tags`**

برای ارسال تگ‌ها به مخزن راه دور می‌توانید از این گزینه استفاده کنید. تگ‌ها معمولاً برای نشانه‌گذاری نسخه‌های مختلف نرم‌افزار استفاده می‌شوند.

```bash
git push origin --tags
```

#### 3. **`git push --set-upstream`**

اگر یک شاخه جدید در مخزن محلی ایجاد کرده‌اید و می‌خواهید آن را به شاخه‌ای در مخزن راه دور متصل کنید، می‌توانید از این گزینه استفاده کنید.

```bash
git push --set-upstream origin new-branch
```

این دستور باعث می‌شود که شاخه `new-branch` به عنوان شاخه ردیابی‌شده‌ای در مخزن `origin` تنظیم شود.

### مشکلات رایج هنگام استفاده از `git push`

#### 1. **خطای Rejected:**

این خطا زمانی رخ می‌دهد که مخزن راه دور تغییراتی داشته که شما هنوز آن‌ها را دریافت نکرده‌اید. در این حالت، باید ابتدا تغییرات را با `git pull` دریافت کنید و سپس دوباره `git push` انجام دهید.

```plaintext
error: failed to push some refs to 'https://github.com/user/repository.git'
hint: Updates were rejected because the remote contains work that you do
hint: not have locally. This is usually caused by another repository pushing
hint: to the same ref. You may want to first integrate the remote changes
hint: (e.g., 'git pull ...') before pushing again.
```

#### 2. **خطای Permission Denied:**

این خطا زمانی رخ می‌دهد که شما به مخزن راه دور دسترسی ندارید یا اعتبارسنجی ورود شما به درستی انجام نشده است. معمولاً در مخازن خصوصی یا در استفاده از پروتکل SSH رخ می‌دهد.

```plaintext
Permission denied (publickey).
```

برای حل این مشکل، باید کلید SSH خود را در سیستم تنظیم کنید یا از اعتبارسنجی HTTPS استفاده کنید.

### نحوه کار با شاخه‌های مختلف و `git push`

برای مدیریت شاخه‌های مختلف، گیت این امکان را می‌دهد که تغییرات هر شاخه به صورت مجزا به مخزن راه دور ارسال شود. شما می‌توانید شاخه‌های جدید ایجاد کنید و آن‌ها را با مخزن راه دور همگام کنید.

#### مثال:

1. **ایجاد یک شاخه جدید و ارسال آن به مخزن راه دور:**

```bash
git checkout -b feature-branch
git push origin feature-branch
```

2. **ارسال تغییرات به شاخه‌ای مشخص:**

```bash
git push origin main
```

در این مثال، تغییرات شاخه `main` به مخزن راه دور ارسال می‌شود.

### نکات و ترفندها

#### 1. **استفاده از `git push --force-with-lease`:**

اگر نیاز به بازنویسی تغییرات در مخزن راه دور دارید، بهتر است به جای استفاده از `--force` از `--force-with-lease` استفاده کنید. این گزینه تغییرات شما را فقط در صورتی ارسال می‌کند که کسی دیگری در بین ارسال شما تغییری ایجاد نکرده باشد.

```bash
git push --force-with-lease origin main
```

#### 2. **استفاده از `git push` بدون نام شاخه:**

اگر در شاخه‌ای هستید که به مخزن راه دور متصل است، نیازی به مشخص کردن نام شا

خه نیست و می‌توانید تنها از `git push` استفاده کنید. گیت به صورت خودکار شاخه فعلی را ارسال می‌کند.

#### 3. **ارسال چندین شاخه به صورت همزمان:**

شما می‌توانید با یک دستور چندین شاخه را به مخزن راه دور ارسال کنید. به این منظور می‌توانید از نام شاخه‌های مختلف در یک دستور استفاده کنید:

```bash
git push origin main feature-branch
```

### نتیجه‌گیری

دستور `git push` یکی از مهم‌ترین ابزارهای گیت برای همگام‌سازی تغییرات مخزن محلی با مخزن راه دور است. این دستور به شما امکان می‌دهد که تغییرات خود را به سرور ارسال کنید و با دیگر اعضای تیم به‌روزرسانی‌ها را به اشتراک بگذارید. با این حال، استفاده صحیح از این دستور و مدیریت تغییرات در مخزن راه دور به‌خصوص در پروژه‌های تیمی نیازمند درک دقیق تفاوت‌ها و مشکلات احتمالی است. استفاده مناسب از گزینه‌های اضافی مانند `--force` و `--tags` نیز به شما کمک می‌کند که فرآیند push را بهینه‌سازی کنید.
