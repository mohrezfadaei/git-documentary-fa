## راهنمای جامع دستور `git pull`

دستور `git pull` یکی از پرکاربردترین دستورات در گیت (Git) است که برای همگام‌سازی تغییرات مخزن راه دور (remote repository) با مخزن محلی (local repository) استفاده می‌شود. این دستور، در واقع ترکیبی از دو دستور **`git fetch`** و **`git merge`** است که تغییرات جدید را از مخزن راه دور دریافت کرده و آن‌ها را به‌طور خودکار با شاخه محلی ادغام می‌کند.

### دستور `git pull` چه کاری انجام می‌دهد؟

دستور `git pull` ابتدا با مخزن راه دور ارتباط برقرار کرده و تغییرات جدید را با استفاده از **`git fetch`** دریافت می‌کند. سپس این تغییرات را با شاخه محلی شما با استفاده از **`git merge`** ادغام می‌کند. به عبارت دیگر، این دستور به‌طور خودکار تغییرات موجود در مخزن راه دور را دانلود و در شاخه محلی شما ادغام می‌کند، بدون نیاز به اجرای دستورات جداگانه.

#### سینتکس کلی:

```bash
git pull [<remote>] [<branch>]
```

- **`<remote>`:** نام مخزن راه دوری که می‌خواهید تغییرات از آن دریافت کنید (به طور پیش‌فرض `origin` است).
- **`<branch>`:** نام شاخه‌ای که می‌خواهید تغییرات آن را دریافت و ادغام کنید (به طور پیش‌فرض شاخه فعلی شما).

#### نمونه‌های استفاده:

1. **دریافت و ادغام تغییرات از مخزن راه دور:**

```bash
git pull
```

این دستور تغییرات شاخه فعلی را از مخزن راه دور (معمولاً `origin`) دریافت کرده و با شاخه محلی ادغام می‌کند.

2. **دریافت و ادغام تغییرات از شاخه‌ای خاص:**

```bash
git pull origin main
```

این دستور تغییرات شاخه `main` از مخزن `origin` را دریافت و آن‌ها را با شاخه فعلی شما ادغام می‌کند.

#### خروجی `git pull`:

```plaintext
remote: Counting objects: 100% (10/10), done.
remote: Compressing objects: 100% (5/5), done.
Unpacking objects: 100% (10/10), done.
From https://github.com/user/repository
 * branch            main       -> FETCH_HEAD
Updating d6f8e67..b3a9e12
Fast-forward
 file1.txt | 3 +++
 1 file changed, 3 insertions(+)
```

در این خروجی، گیت تغییرات جدید را از مخزن راه دور دریافت کرده و سپس آن‌ها را با شاخه محلی شما ادغام کرده است.

### تفاوت بین `git pull` و `git fetch`

تفاوت اصلی بین `git pull` و `git fetch` در این است که:

- **`git fetch`:** فقط تغییرات را از مخزن راه دور دریافت می‌کند و آن‌ها را در شاخه‌های راه دور مخزن محلی ذخیره می‌کند، اما این تغییرات را به طور خودکار با شاخه محلی شما ادغام نمی‌کند. شما می‌توانید پس از `git fetch` تغییرات را بررسی کرده و سپس به صورت دستی ادغام کنید.
- **`git pull`:** هم تغییرات را از مخزن راه دور دریافت می‌کند و هم آن‌ها را بلافاصله با شاخه محلی شما ادغام می‌کند. این دستور به طور خودکار تغییرات جدید را با شاخه فعلی شما ترکیب می‌کند.

#### تفاوت عملیاتی:

- **`git fetch`:** زمانی که می‌خواهید تغییرات را دریافت کنید ولی هنوز نمی‌خواهید آن‌ها را ادغام کنید، این دستور مفید است.
- **`git pull`:** زمانی که قصد دارید هم تغییرات را دریافت و هم به سرعت آن‌ها را ادغام کنید، از `git pull` استفاده می‌کنید.

#### مثال:

1. **`git fetch`:** فقط دریافت تغییرات بدون ادغام.

   ```bash
   git fetch origin main
   ```

   این دستور تغییرات شاخه `main` در مخزن `origin` را دریافت کرده، ولی شاخه محلی را تغییر نمی‌دهد.

2. **`git pull`:** دریافت و ادغام تغییرات.
   ```bash
   git pull origin main
   ```
   این دستور تغییرات شاخه `main` در مخزن `origin` را دریافت کرده و به طور خودکار آن‌ها را با شاخه محلی شما ادغام می‌کند.

### چه اتفاقی در پس‌زمینه دستور `git pull` می‌افتد؟

وقتی دستور `git pull` اجرا می‌شود، دو فرآیند اصلی به صورت پشت سر هم انجام می‌شود:

#### 1. **دریافت تغییرات با `git fetch`:**

- گیت ابتدا تغییرات جدید را از مخزن راه دور (remote repository) دریافت می‌کند. این تغییرات شامل فایل‌های جدید، کامیت‌های جدید، و تغییرات روی فایل‌ها و شاخه‌های موجود است.
- گیت این تغییرات را به طور جداگانه در شاخه‌های راه دور (remote branches) مانند `origin/main` ذخیره می‌کند.

#### 2. **ادغام تغییرات با `git merge`:**

- پس از دریافت تغییرات، گیت سعی می‌کند این تغییرات را با شاخه محلی شما ادغام کند. اگر تغییرات جدید با تغییرات محلی شما همخوانی داشته باشند، ادغام به‌صورت **`fast-forward`** انجام می‌شود. در غیر این صورت، گیت تلاش می‌کند که تغییرات را ترکیب کند و اگر تعارضی وجود داشته باشد، شما باید مشکلات ادغام (merge conflicts) را به صورت دستی حل کنید.

#### فایل‌های موقت و اطلاعات شاخه‌ها:

در پس‌زمینه، گیت تغییرات جدید را در شاخه‌های راه دور (مثل `refs/remotes/origin/main`) ذخیره می‌کند. سپس این تغییرات به شاخه محلی ادغام می‌شوند و در صورت موفقیت، شاخه محلی شما به‌روزرسانی می‌شود.

### گزینه‌های پرکاربرد با `git pull`

#### 1. **`git pull --rebase`:**

با استفاده از این گزینه، به جای ادغام (merge)، تغییرات جدید به کمک `rebase` اعمال می‌شوند. در این حالت، کامیت‌های محلی شما به بالای تغییرات جدید منتقل می‌شوند و تاریخچه پروژه به صورت خطی باقی می‌ماند.

```bash
git pull --rebase origin main
```

این دستور تغییرات شاخه `main` را از مخزن `origin` دریافت کرده و کامیت‌های محلی شما را به بالای آن‌ها منتقل می‌کند.

#### 2. **`git pull --ff-only`:**

این گزینه اطمینان حاصل می‌کند که ادغام تنها در صورتی انجام می‌شود که گیت بتواند به‌صورت **fast-forward** عمل کند. اگر ادغام نیاز به کامیت ادغام (merge commit) داشته باشد، عملیات متوقف خواهد شد.

```bash
git pull --ff-only origin main
```

این دستور تغییرات را فقط در صورت امکان **fast-forward** دریافت و ادغام می‌کند.

#### 3. **`git pull --no-commit`:**

این گزینه اجازه می‌دهد که گیت تغییرات جدید را دریافت و ادغام کند، اما به‌طور خودکار کامیتی ایجاد نکند. شما می‌توانید تغییرات را قبل از کامیت بررسی کرده و سپس کامیت کنید.

```bash
git pull --no-commit origin main
```

این دستور تغییرات را دریافت کرده و ادغام می‌کند، اما کامیت نهایی را به شما واگذار می‌کند.

### مشکلات احتمالی در استفاده از `git pull`

#### 1. **تعارضات ادغام (Merge Conflicts):**

هنگامی که `git pull` اجرا می‌شود و تغییرات جدید با تغییرات محلی شما در تضاد هستند، گیت نمی‌تواند به‌صورت خودکار آن‌ها را ادغام کند و تعارض (conflict) ایجاد می‌شود. در این حالت، شما باید تعارضات را به صورت دستی حل کرده و سپس تغییرات را کامیت کنید.

#### 2. **ادغام‌های غیرضروری:**

گاهی اوقات استفاده از `git pull` باعث ایجاد کامیت‌های ادغام غیرضروری می‌شود، به خصوص اگر شاخه محلی شما به‌روز نباشد. برای جلوگیری از این موضوع، می‌توانید از `git pull --rebase` استفاده کنید که تاریخچه را خطی نگه می‌دارد.

### نکات و ترفندها

#### 1. **استفاده از `git pull --rebase`:**

در پروژه‌های بزرگ، بهتر است به جای `git pull` از `git pull --rebase` استفاده کنید تا از ایجاد کامیت‌های ادغام غیرضروری جلوگیری کرده و تاریخچه پروژه خود را خطی و تمیز نگه دارید.

#### 2. **استفاده از `git fetch` قبل از `git pull`:**

برای کاهش احتمال مشکلات ادغام و جلوگیری از تعارضات، بهتر است ابتدا از `git fetch` برای دریافت تغییرات استفاده کنید و سپس تغییرات را بررسی کنید. در نهایت می‌توانید با اجرای `git merge` یا `git pull` تغییرات را ادغام کنید.

```bash
git fetch origin
git log origin/main
git merge origin/main
```

#### 3. **مدیریت تعارضات ادغام:**

در صورت بروز تعارض، گیت فایل‌هایی که نیاز به حل تعارض دارند را با نشانگرهای مخصوصی مشخص می

‌کند. شما باید این تعارضات را حل کنید، سپس تغییرات را به ناحیه آماده‌سازی (staging area) اضافه کرده و کامیت کنید.

```bash
git add <filename>
git commit
```

### نتیجه‌گیری

دستور `git pull` ابزاری قدرتمند برای همگام‌سازی تغییرات مخزن محلی با مخزن راه دور است. این دستور به شما امکان می‌دهد تغییرات جدید را به سرعت دریافت کرده و آن‌ها را با شاخه محلی خود ادغام کنید. با این حال، استفاده درست از این دستور، به خصوص در پروژه‌های بزرگ، نیازمند درک دقیق تفاوت‌های `git pull` و `git fetch`، و مدیریت تعارضات احتمالی است. با استفاده مناسب از گزینه‌های اضافی مانند `--rebase` و `--ff-only`، می‌توانید از بروز مشکلات رایج جلوگیری کرده و تاریخچه پروژه خود را تمیز و مرتب نگه دارید.
