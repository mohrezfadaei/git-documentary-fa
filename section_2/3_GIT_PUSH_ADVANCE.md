## آپشن‌های پیشرفته در `git push` و نحوه استفاده از SSH

دستور `git push` به طور کلی برای ارسال تغییرات از مخزن محلی به مخزن راه دور استفاده می‌شود. با این حال، این دستور گزینه‌های پیشرفته‌ای دارد که به شما امکان کنترل بیشتری در فرآیند push می‌دهد. همچنین، استفاده از **SSH** برای احراز هویت به جای HTTP/HTTPS امنیت بیشتری فراهم می‌کند و نیازی به وارد کردن مکرر رمز عبور ندارد.

### آپشن‌های پیشرفته در `git push`

#### 1. `git push --force`

گزینه `--force` برای زمانی استفاده می‌شود که شما نیاز دارید تاریخچه مخزن راه دور را بازنویسی کنید، بدون در نظر گرفتن تغییرات موجود در آن. این گزینه زمانی کاربرد دارد که شما تغییراتی را در شاخه محلی انجام داده‌اید که با شاخه راه دور ناسازگار است (مثلاً پس از rebase)، اما همچنان می‌خواهید آن‌ها را به زور push کنید.

**مثال:**

```bash
git push --force origin main
```

**هشدار:** استفاده از `--force` ممکن است باعث از دست رفتن تغییرات دیگران در مخزن راه دور شود. بهتر است با احتیاط از این گزینه استفاده کنید و قبل از آن مطمئن شوید که هیچ تغییراتی از دیگران از دست نمی‌رود.

#### 2. `git push --force-with-lease`

گزینه `--force-with-lease` یک جایگزین ایمن‌تر برای `--force` است. این گزینه اطمینان حاصل می‌کند که تغییرات شما تنها در صورتی push می‌شوند که هیچ‌کس دیگری در شاخه راه دور تغییری اعمال نکرده باشد. در واقع این گزینه بررسی می‌کند که شاخه راه دور هنوز همان حالتی است که شما آخرین بار با آن کار کرده‌اید.

**مثال:**

```bash
git push --force-with-lease origin main
```

این گزینه از بازنویسی ناخواسته تغییرات دیگران جلوگیری می‌کند و تنها در صورتی تغییرات شما را push می‌کند که هیچ تغییر دیگری رخ نداده باشد.

#### 3. `git push --tags`

با استفاده از این گزینه، شما می‌توانید تمامی تگ‌های موجود در مخزن محلی خود را به مخزن راه دور ارسال کنید. تگ‌ها معمولاً برای نسخه‌گذاری (versioning) پروژه‌ها استفاده می‌شوند و برای نشانه‌گذاری نسخه‌های پایدار بسیار مفید هستند.

**مثال:**

```bash
git push origin --tags
```

این دستور تمامی تگ‌های محلی شما را به مخزن `origin` ارسال می‌کند.

#### 4. `git push --all`

این گزینه به شما اجازه می‌دهد تمامی شاخه‌های موجود در مخزن محلی خود را به مخزن راه دور ارسال کنید. این گزینه به ویژه برای پروژه‌هایی مفید است که شما روی چندین شاخه به صورت همزمان کار می‌کنید و می‌خواهید همه آن‌ها را به مخزن راه دور push کنید.

**مثال:**

```bash
git push origin --all
```

این دستور تمام شاخه‌های موجود را به مخزن `origin` ارسال می‌کند.

#### 5. `git push --set-upstream`

وقتی شما یک شاخه جدید در مخزن محلی ایجاد می‌کنید و می‌خواهید این شاخه را به مخزن راه دور push کنید، از این گزینه برای تنظیم این شاخه به عنوان شاخه پیگیری‌شده (tracking branch) استفاده می‌کنید. با این کار، گیت به صورت خودکار شاخه محلی شما را با شاخه راه دور همگام می‌کند.

**مثال:**

```bash
git push --set-upstream origin new-branch
```

این دستور شاخه `new-branch` را به مخزن `origin` ارسال می‌کند و آن را به عنوان شاخه پیگیری‌شده تنظیم می‌کند.

#### 6. `git push --dry-run`

گزینه `--dry-run` به شما اجازه می‌دهد که تغییراتی که قرار است push شوند را بدون اعمال واقعی بررسی کنید. این دستور تغییرات را شبیه‌سازی می‌کند تا مطمئن شوید که چه چیزی قرار است push شود.

**مثال:**

```bash
git push --dry-run origin main
```

این دستور به شما نشان می‌دهد که چه چیزی قرار است push شود، اما هیچ تغییری در مخزن راه دور اعمال نمی‌کند.

### نحوه استفاده از SSH در گیت

استفاده از **SSH** در گیت یکی از بهترین راه‌ها برای احراز هویت و ارتباط امن با مخازن راه دور است. استفاده از SSH به شما این امکان را می‌دهد که بدون نیاز به وارد کردن مکرر نام کاربری و رمز عبور، به راحتی تغییرات خود را push یا pull کنید. همچنین امنیت بیشتری در مقایسه با HTTPS فراهم می‌کند.

#### مراحل تنظیم SSH برای گیت

##### 1. ایجاد کلید SSH

ابتدا باید یک جفت کلید عمومی و خصوصی SSH برای سیستم خود ایجاد کنید. برای این کار، از دستور زیر استفاده کنید:

```bash
ssh-keygen -t ed25519 -C "your_email@example.com"
```

اگر الگوریتم `ed25519` در سیستم شما پشتیبانی نمی‌شود، می‌توانید از `rsa` استفاده کنید:

```bash
ssh-keygen -t rsa -b 4096 -C "your_email@example.com"
```

این دستور یک جفت کلید SSH برای شما تولید می‌کند. پس از اجرای این دستور، شما باید محل ذخیره کلیدها را مشخص کنید (معمولاً در مسیر `~/.ssh/id_ed25519` یا `~/.ssh/id_rsa` ذخیره می‌شوند).

##### 2. افزودن کلید SSH به SSH-Agent

برای مدیریت کلیدهای SSH، باید آن‌ها را به SSH-Agent اضافه کنید. ابتدا SSH-Agent را اجرا کنید:

```bash
eval "$(ssh-agent -s)"
```

سپس کلید خود را به SSH-Agent اضافه کنید:

```bash
ssh-add ~/.ssh/id_ed25519
```

یا اگر از الگوریتم `rsa` استفاده کرده‌اید:

```bash
ssh-add ~/.ssh/id_rsa
```

##### 3. کپی کردن کلید عمومی

اکنون باید کلید عمومی خود را به مخزن راه دور (مثلاً GitHub یا GitLab) اضافه کنید. برای این کار، ابتدا کلید عمومی خود را کپی کنید:

```bash
cat ~/.ssh/id_ed25519.pub
```

این دستور کلید عمومی شما را در ترمینال نمایش می‌دهد. کلید را کپی کرده و در حساب GitHub یا GitLab خود قرار دهید.

##### 4. اضافه کردن کلید به حساب GitHub/GitLab

به حساب GitHub یا GitLab خود بروید و مراحل زیر را دنبال کنید:

- در GitHub:

  - وارد حساب کاربری خود شوید.
  - به تنظیمات (Settings) بروید.
  - در بخش "SSH and GPG keys"، گزینه "New SSH key" را انتخاب کنید.
  - کلید کپی شده را در این بخش وارد کرده و ذخیره کنید.

- در GitLab:
  - وارد حساب کاربری خود شوید.
  - به "Preferences" بروید.
  - در بخش "SSH Keys"، کلید کپی شده را وارد کنید.

##### 5. کلون کردن یا push با استفاده از SSH

اکنون شما می‌توانید از SSH برای ارتباط با مخزن‌های گیت استفاده کنید. برای کلون کردن مخزن با استفاده از SSH، از URL با فرمت SSH استفاده کنید:

```bash
git clone git@github.com:user/repository.git
```

و برای push یا pull کردن تغییرات نیازی به وارد کردن نام کاربری یا رمز عبور نخواهید داشت.

#### تغییر URL مخزن از HTTPS به SSH

اگر قبلاً مخزنی را با استفاده از HTTPS کلون کرده‌اید و می‌خواهید آن را به SSH تغییر دهید، می‌توانید از دستور زیر استفاده کنید:

```bash
git remote set-url origin git@github.com:user/repository.git
```

این دستور URL مخزن `origin` را به فرمت SSH تغییر می‌دهد.

### نتیجه‌گیری

دستور `git push` با آپشن‌های پیشرفته‌ای که ارائه می‌دهد، کنترل بیشتری بر فرآیند ارسال تغییرات به مخازن راه دور فراهم می‌کند. استفاده از SSH به جای HTTPS نه تنها امنیت بیشتری دارد، بلکه فرآیند احراز هویت را برای شما ساده‌تر می‌کند. با تنظیم SSH و استفاده از آپشن‌های مناسب `git push`، می‌توانید به راحتی تغییرات خود را مدیریت و همگام‌سازی کنید.
